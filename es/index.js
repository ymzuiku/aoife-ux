function c(t){try{return decodeURIComponent(t.replace(/\+/g," "))}catch(e){return null}}function g(t,e){if(!t)return null;let i=/([^=?&]+)=?([^&]*)/g,o={},n;for(;n=i.exec(t);){let s=c(n[1]),r=c(n[2]);s===null||r===null||s in o||(e||(r=isNaN(Number(r))?r:Number(r)),o[s]=r)}return o}function m(t,e=""){let i=[],o,n;typeof e!="string"&&(e="?");for(n in t)if(Object.prototype.hasOwnProperty.call(t,n)){if(o=t[n],!o&&(o==null||isNaN(o))&&(o=""),n=encodeURIComponent(n),o=encodeURIComponent(o),n===null||o===null)continue;i.push(`${n}=${o}`)}return i.length?e+i.join("&"):""}var b={parse:g,stringify:m,decode:c},l=b;var h=[];["popstate","pushState","replaceState"].forEach(t=>{window.addEventListener(t,()=>{a.state=l.parse(location.search),h.forEach(e=>e())})});function f(t){let e=document.createElement("span");return e.style.display="none",e.setAttribute("aoife-route",t),e}var w=0,a=({root:t,url:e,render:i,preload:o})=>{if(typeof i!="function")throw"AoifeRoute.render need a Function";w+=1;let n=""+w,s=()=>{if(o&&i(),typeof e=="function"){if(!e())return f(n)}else{let u=!1;if(t&&window.location.pathname==="/"&&(u=!0),!u&&l.decode(window.location.pathname)!==e)return f(n)}let r=i();if(r.then){let u=f(n);return Promise.resolve(r).then(p=>{if(p.default){let d=document.querySelector(`[aoife-route="${n}"]`);if(!d)return;let y=p.default();y.setAttribute("aoife-route",n),d.replaceWith(y)}}),u}return r.setAttribute("aoife-route",n),r};return h.push(()=>{let r=document.querySelector(`[aoife-route="${n}"]`);!r||r.replaceWith(s())}),s()};a.state={};a.queryString=l;a.push=(t,e,i)=>{e&&(t+="?"+l.stringify(e)),i||window.scrollTo&&window.scrollTo({top:0}),setTimeout(()=>{history.pushState(e,"",t),window.dispatchEvent(new Event("pushState"))})};a.replace=(t,e,i)=>{e&&(t+="?"+l.stringify(e)),i||window.scrollTo&&window.scrollTo({top:0}),setTimeout(()=>{history.replaceState(e,"",t),window.dispatchEvent(new Event("replaceState"))})};a.back=()=>{history.back()};var S=a;export{S as default};
